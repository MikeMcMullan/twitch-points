new Vue({el:"#bot-log",data:{buttons:{start:!1,stop:!1,join:!1,leave:!1},refreshing_log:!1,starting_bot:!1,stopping_bot:!1,joining_channel:!1,leaving_channel:!1,bot_status:"Unknown",offset:0,entries:[],alerts:[]},computed:{},ready:function(){var t=this;t.fetchEntries();var o=function(){setTimeout(function(){t.fetchEntries(),o()},2e3)};o()},methods:{toggleButton:function(t,o){var e=this,n=function(){e[buttons][property]=!e[buttons][property]};return o?void setTimeout(n,o):void n()},makeBotControlRequest:function(t,o){var e=this,n=$.ajax({url:t,method:"GET",dataType:"json"});n.done(o)},fetchEntries:function(){var t=this,o=$.ajax({url:"/api/bot/log",method:"GET",data:{offset:this.offset},dataType:"json"});o.done(function(o){if(o.error)return t.entries=[o.error],void(t.bot_status="Error");t.offset=o.new_offset,t.bot_status=o.status,"RUNNING"!==t.bot_status?(t.buttons.join=!1,t.buttons.leave=!1,t.buttons.stop=!1,t.buttons.start=!0):"RUNNING"===t.bot_status?(t.buttons.start=!1,t.buttons.join=!0,t.buttons.leave=!0,t.buttons.stop=!0):(t.buttons.join=!0,t.buttons.leave=!0,t.buttons.stop=!0);for(var e in o.entries)t.entries.unshift(o.entries[e])})},startBot:function(){var t=this;t.buttons.join=!1,t.buttons.leave=!1,t.buttons.stop=!1,t.buttons.start=!1,this.makeBotControlRequest("/api/bot/start",function(o){o.error&&(t.alerts.push({level:"danger",msg:o.error}),setTimeout(function(){t.alerts.pop()},2e3))})},stopBot:function(){var t=this;t.buttons.join=!1,t.buttons.leave=!1,t.buttons.stop=!1,t.buttons.start=!1,this.makeBotControlRequest("/api/bot/stop",function(o){o.error&&(t.alerts.push({level:"danger",msg:o.error}),setTimeout(function(){t.alerts.pop()},2e3))})},joinChannel:function(){var t=this;this.makeBotControlRequest("/api/bot/join",function(o){o.error&&(t.alerts.push({level:"danger",msg:o.error}),setTimeout(function(){t.alerts.pop()},2e3))})},leaveChannel:function(){var t=this;this.makeBotControlRequest("/api/bot/leave",function(o){o.error&&(t.alerts.push({level:"danger",msg:o.error}),setTimeout(function(){t.alerts.pop()},2e3))})}}});